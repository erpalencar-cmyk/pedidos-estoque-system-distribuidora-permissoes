# ğŸ—ï¸ Arquitetura do Sistema de PermissÃµes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SISTEMA DE PERMISSÃ•ES DINÃ‚MICAS                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BANCO DE DADOS                           â”‚
â”‚                    (Supabase - PostgreSQL)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   modulos   â”‚  â”‚   perfis    â”‚  â”‚ permissoes_modulos   â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ id          â”‚  â”‚ id          â”‚  â”‚ id                   â”‚   â”‚
â”‚  â”‚ nome        â”‚  â”‚ nome        â”‚  â”‚ perfil_id  â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚ slug        â”‚  â”‚ descricao   â”‚  â”‚ modulo_id  â”€â”€â”â”‚      â”‚   â”‚
â”‚  â”‚ icone       â”‚  â”‚ ativo       â”‚  â”‚ pode_acessar â”‚â”‚      â”‚   â”‚
â”‚  â”‚ ativo       â”‚  â”‚             â”‚  â”‚ pode_criar   â”‚â”‚      â”‚   â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚ pode_editar  â”‚â”‚      â”‚   â”‚
â”‚  â”‚ â€¢ dashboard â”‚  â”‚ â€¢ ADMIN     â”‚  â”‚ pode_deletar â”‚â”‚      â”‚   â”‚
â”‚  â”‚ â€¢ produtos  â”‚  â”‚ â€¢ VENDEDOR  â”‚  â”‚              â”‚â”‚      â”‚   â”‚
â”‚  â”‚ â€¢ estoque   â”‚  â”‚ â€¢ COMPRADOR â”‚  â”‚ Exemplo: â”€â”€â”€â”€â”˜â”‚      â”‚   â”‚
â”‚  â”‚ â€¢ vendas    â”‚  â”‚ â€¢ APROVADOR â”‚  â”‚ VENDEDOR â†’    â”‚      â”‚   â”‚
â”‚  â”‚ â€¢ pdv       â”‚  â”‚ â€¢ GERENTE   â”‚  â”‚ pode acessar  â”‚      â”‚   â”‚
â”‚  â”‚ â€¢ ...       â”‚  â”‚             â”‚  â”‚ ESTOQUE       â”‚      â”‚   â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚               â”‚      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  acoes_modulo   â”‚  â”‚  permissoes_acoes      â”‚                â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
â”‚  â”‚ id              â”‚  â”‚ id                     â”‚                â”‚
â”‚  â”‚ modulo_id       â”‚  â”‚ acao_id                â”‚                â”‚
â”‚  â”‚ nome (aÃ§Ã£o)     â”‚  â”‚ perfil_id              â”‚                â”‚
â”‚  â”‚ slug            â”‚  â”‚ pode_executar          â”‚                â”‚
â”‚  â”‚                 â”‚  â”‚                        â”‚                â”‚
â”‚  â”‚ Ex:             â”‚  â”‚ (Para aÃ§Ãµes customizas)â”‚                â”‚
â”‚  â”‚ â€¢ Pode cancelar â”‚  â”‚                        â”‚                â”‚
â”‚  â”‚ â€¢ Pode reimprimir
â”‚  â”‚ â€¢ Pode duplicar â”‚  â”‚                        â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      INTERFACE DE ADMIN                          â”‚
â”‚              (pages/gerenciar-permissoes.html)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  [Admin] [Vendedor] [Comprador] [Aprovador] [Gerente]           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                  â”‚
â”‚  â”‚ MÃ³dulo       â”‚ Acessar â”‚ Criar â”‚ Editar â”‚ Deletar â”‚          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚  â”‚ Dashboard    â”‚    â˜‘    â”‚   â˜‘   â”‚   â˜‘    â”‚   â˜‘    â”‚          â”‚
â”‚  â”‚ Produtos     â”‚    â˜‘    â”‚   â˜‘   â”‚   â˜‘    â”‚   â˜’    â”‚          â”‚
â”‚  â”‚ Estoque      â”‚    â˜‘    â”‚   â˜‘   â”‚   â˜‘    â”‚   â˜’    â”‚          â”‚
â”‚  â”‚ Vendas       â”‚    â˜‘    â”‚   â˜‘   â”‚   â˜‘    â”‚   â˜’    â”‚          â”‚
â”‚  â”‚ Pedidos      â”‚    â˜‘    â”‚   â˜‘   â”‚   â˜‘    â”‚   â˜’    â”‚          â”‚
â”‚  â”‚ Fornecedores â”‚    â˜‘    â”‚   â˜‘   â”‚   â˜‘    â”‚   â˜’    â”‚          â”‚
â”‚  â”‚ PDV          â”‚    â˜‘    â”‚   â˜‘   â”‚   â˜‘    â”‚   â˜‘    â”‚          â”‚
â”‚  â”‚ ...          â”‚   ...   â”‚  ...  â”‚  ...   â”‚  ...   â”‚          â”‚
â”‚  â”‚                                              â˜‘ Alterada       â”‚
â”‚  â”‚                              [Redefinir] [Salvar AlteraÃ§Ãµes]  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CAMADA DE JAVASCRIPT                           â”‚
â”‚                  (js/permissoes.js)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  PermissaoManager CLASS:                                        â”‚
â”‚  â”œâ”€ obterRoleUsuario()                                          â”‚
â”‚  â”œâ”€ podeAcessarModulo(slug)    â† Verifica com banco            â”‚
â”‚  â”œâ”€ obterModulosDisponiveis()                                  â”‚
â”‚  â”œâ”€ _verificarPermissaoLocal() â† Fallback hardcoded            â”‚
â”‚  â””â”€ ...outros mÃ©todos...                                       â”‚
â”‚                                                                  â”‚
â”‚  Helper Functions:                                              â”‚
â”‚  â”œâ”€ verificarAcessoModulo(slug, redirect)                      â”‚
â”‚  â”œâ”€ protegerPaginaPorModulo(slug)                              â”‚
â”‚  â””â”€ permissaoManager (instÃ¢ncia global)                        â”‚
â”‚                                                                  â”‚
â”‚  Uso nas PÃ¡ginas:                                               â”‚
â”‚  â”œâ”€ <script src="../js/permissoes.js"></script>                â”‚
â”‚  â””â”€ verificarAcessoModulo('pdv', true) â† Protege pÃ¡gina        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO DE VERIFICAÃ‡ÃƒO                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  UsuÃ¡rio acessa pÃ¡gina.html                                    â”‚
â”‚        â†“                                                        â”‚
â”‚  verificarAcessoModulo('modulo-slug', true)                    â”‚
â”‚        â†“                                                        â”‚
â”‚  [TENTAR] Consultar banco de dados                             â”‚
â”‚        â”‚                                                        â”‚
â”‚        â”œâ”€â†’ [SUCESSO] Retorna true/false (permissÃ£o do BD)     â”‚
â”‚        â”‚              â€¢ Se true:  Permite acesso               â”‚
â”‚        â”‚              â€¢ Se false: Redireciona para dashboard   â”‚
â”‚        â”‚                                                        â”‚
â”‚        â””â”€â†’ [ERRO] Usa fallback hardcoded                       â”‚
â”‚                   (Se tabelas nÃ£o existem ou erro de conexÃ£o)   â”‚
â”‚                   â€¢ Retorna resultado do _verificarPermissaoLocal()
â”‚                                                                  â”‚
â”‚  âœ… Bloco de seguranÃ§a em 2 camadas                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ARQUIVOS DO SISTEMA                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ğŸ“¦ Core System:                                                â”‚
â”‚  â”œâ”€ js/permissoes.js              [NEW] PermissaoManager class  â”‚
â”‚  â”œâ”€ database/criar-sistema-permissoes.sql  [NEW] SQL script     â”‚
â”‚  â”‚  â””â”€ Cria 5 tabelas + dados iniciais + RLS                  â”‚
â”‚  â”‚  â””â”€ Precisa ser executado uma vez no Supabase              â”‚
â”‚  â”‚                                                             â”‚
â”‚  ğŸ“„ Interface de Admin:                                         â”‚
â”‚  â”œâ”€ pages/gerenciar-permissoes.html  [NEW] Ãndice de perm.     â”‚
â”‚  â”œâ”€ admin-painel.html                [UPDATED] Link adicionado  â”‚
â”‚  â”‚                                                              â”‚
â”‚  ğŸ“– DocumentaÃ§Ã£o:                                               â”‚
â”‚  â”œâ”€ GUIA_SISTEMA_PERMISSOES.md       [NEW] Guia completo       â”‚
â”‚  â”œâ”€ GUIA_RAPIDO_PERMISSOES.md        [NEW] Quick start          â”‚
â”‚  â”œâ”€ ARQUITETURA_PERMISSOES.md        [THIS FILE]               â”‚
â”‚  â””â”€ CHECKLIST_SISTEMA_PERMISSOES.md  [NEW] Progresso           â”‚
â”‚                                                                  â”‚
â”‚  ğŸ”§ PÃ¡ginas Atualizadas:                                        â”‚
â”‚  â”œâ”€ pages/configuracoes-empresa.html   [UPDATED] Usa new sys.  â”‚
â”‚  â”œâ”€ pages/pdv.html                     [UPDATED] Usa new sys.  â”‚
â”‚  â””â”€ +18 pÃ¡ginas com aguardarClientePronto() [UPDATED]         â”‚
â”‚                                                                  â”‚
â”‚  âš™ï¸ Suporte:                                                     â”‚
â”‚  â”œâ”€ js/config.js                       [UPDATED] client init    â”‚
â”‚  â”œâ”€ js/utils.js                        [UPDATED] getCurrentUser â”‚
â”‚  â””â”€ js/rbac.js                         [OLD] Ainda existe       â”‚
â”‚     (Removido gradualmente, fallback ainda funciona)           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FLUXO COMPLETO DE EXECUÃ‡ÃƒO                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. ADMIN CONFIGURA PERMISSÃ•ES                                 â”‚
â”‚     â””â”€ Acessa: /pages/gerenciar-permissoes.html               â”‚
â”‚     â””â”€ Marca/desmarque permissÃµes de mÃ³dulos                  â”‚
â”‚     â””â”€ Clica "Salvar AlteraÃ§Ãµes"                              â”‚
â”‚     â””â”€ JavaScript salva em permissoes_modulos (Supabase)      â”‚
â”‚                                                                 â”‚
â”‚  2. USUÃRIO ACESSA PÃGINA                                      â”‚
â”‚     â””â”€ Acessa: /pages/pdv.html                               â”‚
â”‚     â””â”€ pdv.html carrega e chama:                              â”‚
â”‚        verificarAcessoModulo('pdv', true)                     â”‚
â”‚                                                                 â”‚
â”‚  3. VERIFICAÃ‡ÃƒO DE PERMISSÃƒO                                   â”‚
â”‚     â””â”€ permissoes.js verifica:                                â”‚
â”‚        SELECT * FROM permissoes_modulos                       â”‚
â”‚        WHERE perfil_id = user.role                            â”‚
â”‚        AND modulo_id = (id do mÃ³dulo 'pdv')                   â”‚
â”‚                                                                 â”‚
â”‚  4. RESULTADO                                                   â”‚
â”‚     â”œâ”€ Se pode_acessar = true â†’ Mostra pÃ¡gina                â”‚
â”‚     â””â”€ Se pode_acessar = false â†’ Redireciona para dashboard  â”‚
â”‚                                                                 â”‚
â”‚  âœ¨ Toda a lÃ³gica sem alterar cÃ³digo!                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SISTEMA DE FALLBACK                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Se tabela permissoes_modulos NÃƒO existir ou tiver erro:      â”‚
â”‚                                                                  â”‚
â”‚  PermissaoManager._verificarPermissaoLocal(role, modulo)      â”‚
â”‚  {                                                              â”‚
â”‚    const permissoes = {                                        â”‚
â”‚      'ADMIN': ['*'],  â† Acesso total                          â”‚
â”‚      'VENDEDOR': ['dashboard', 'produtos', 'estoque',         â”‚
â”‚                   'vendas', 'pdv', 'clientes'],               â”‚
â”‚      'COMPRADOR': ['produtos', 'fornecedores',                â”‚
â”‚                    'pedidos-compra'],                          â”‚
â”‚      'APROVADOR': ['dashboard', 'analises',                   â”‚
â”‚                    'vendas', 'pedidos-compra'],                â”‚
â”‚      'GERENTE': ['dashboard', 'analises']                     â”‚
â”‚    }                                                           â”‚
â”‚    return permissoes[role]?.includes(modulo)                  â”‚
â”‚  }                                                              â”‚
â”‚                                                                  â”‚
â”‚  âœ… Sistema continua funcionando mesmo sem banco de dados    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DIAGRAMA DE ESTADO                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚   â”‚ INÃCIO  â”‚                                                  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                  â”‚
â”‚        â”‚                                                        â”‚
â”‚        â†“                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚   â”‚ SQL Executado?       â”‚                                    â”‚
â”‚   â”‚ (tabelas existem?)   â”‚                                    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚         â”‚                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚    â”‚            â”‚                                              â”‚
â”‚   NÃƒO          SIM                                             â”‚
â”‚    â”‚            â”‚                                              â”‚
â”‚    â†“            â†“                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚ â”‚ERRO  â”‚    â”‚ Usa Banco de Dados  â”‚                          â”‚
â”‚ â”‚      â”‚    â”‚ permissoes_modulos  â”‚                          â”‚
â”‚ â”‚TENTA â”‚    â”‚                     â”‚                          â”‚
â”‚ â”‚FALL- â”‚    â”‚ âœ… DinÃ¢mico        â”‚                          â”‚
â”‚ â”‚BACK  â”‚    â”‚ âœ… AtualizÃ¡vel     â”‚                          â”‚
â”‚ â”‚      â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚ â”‚      â”‚               â”‚                                       â”‚
â”‚ â”‚ FB:  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚ â”‚HC    â”‚    â”‚                                                  â”‚
â”‚ â”‚PP    â”‚    â†“                                                  â”‚
â”‚ â”‚      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜ â”‚ PÃGINA EXIBE     â”‚                                â”‚
â”‚    â”‚     â”‚ OU REDIRECIONA   â”‚                                â”‚
â”‚    â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                â”‚
â”‚  FC = Fallback Checado          HC = Hardcoded              â”‚
â”‚  PP = PermissÃµes PrÃ©-configuradas                            â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ğŸ“Š RESUMO TÃ‰CNICO

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Componente      â”‚ Tipo             â”‚ Status          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Banco Dados     â”‚ PostgreSQL (+RLS) â”‚ âœ… Criado      â”‚
â”‚ Manager JS      â”‚ Class            â”‚ âœ… Implementadoâ”‚
â”‚ Interface HTML  â”‚ UI Admin         â”‚ âœ… Criada      â”‚
â”‚ Helper Functionsâ”‚ JS Utilities     â”‚ âœ… Implementadoâ”‚
â”‚ Fallback System â”‚ Hardcoded Config â”‚ âœ… Implementadoâ”‚
â”‚ DocumentaÃ§Ã£o    â”‚ Markdown         â”‚ âœ… Completa    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ExecuÃ§Ã£o SQL    â”‚ PENDENTE         â”‚ â³ Aguardando  â”‚
â”‚ Testes          â”‚ PENDENTE         â”‚ â³ Aguardando  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Fluxo de Desenvolvimento Recomendado

```
1. Executar der-sistema-permissoes.sql
   â†“
2. Testar interface (gerenciar-permissoes.html)
   â†“
3. Alterar permissÃµes de teste
   â†“
4. Verificar acesso em pÃ¡ginas atualizadas
   â†“
5. Atualizar pÃ¡ginas faltantes (teste-focus-nfe, etc)
   â†“
6. Testes completos com diferentes roles
   â†“
7. Deploy em produÃ§Ã£o
   â†“
8. Monitoramento e feedback
```

---

**Diagrama criado**: 2024
**VersÃ£o**: 1.0
**Status**: âœ… Sistema Pronto
